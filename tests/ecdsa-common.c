#include <inttypes.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <stdbool.h>
#include <time.h>

#include <stdio.h>
#include <stdlib.h>

#include <unistd.h>

#include "Hacl_ECDSA.h"


bool testEcdsaSignature0()
{

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t m[32] = {0x56,  0xec,  0x33,  0xa1,  0xa6,  0xe7,  0xc4,  0xdb,  0x77,  0x03,  0x90,  0x1a,  0xfb,  0x2e,  0x1e,  0x4e,  0x50,  0x09,  0xfe,  0x04,  0x72,  0x89,  0xc5,  0xc2,  0x42,  0x13,  0x6c,  0xe3,  0xb7,  0xf6,  0xac,  0x44};
    uint8_t privateKey[32] = {0x64,  0xb4,  0x72,  0xda,  0x6d,  0xa5,  0x54,  0xca,  0xac,  0x3e,  0x4e,  0x0b,  0x13,  0xc8,  0x44,  0x5b,  0x1a,  0x77,  0xf4,  0x59,  0xee,  0xa8,  0x4f,  0x1f,  0x58,  0x8b,  0x5f,  0x71,  0x3d,  0x42,  0x9b,  0x51};
    uint8_t k[32] = {0xde,  0x68,  0x2a,  0x64,  0x87,  0x07,  0x67,  0xb9,  0x33,  0x5d,  0x4f,  0x82,  0x47,  0x62,  0x4a,  0x3b,  0x7f,  0x3c,  0xe9,  0xf9,  0x45,  0xf2,  0x80,  0xa2,  0x61,  0x6a,  0x90,  0x4b,  0xb1,  0xbb,  0xa1,  0x94};
    uint8_t expectedR[32] = {0xac,  0xc2,  0xc8,  0x79,  0x6f,  0x5e,  0xbb,  0xca,  0x7a,  0x5a,  0x55,  0x6a,  0x1f,  0x6b,  0xfd,  0x2a,  0xed,  0x27,  0x95,  0x62,  0xd6,  0xe3,  0x43,  0x88,  0x5b,  0x79,  0x14,  0xb5,  0x61,  0x80,  0xac,  0xf3};
    uint8_t expectedS[32] = {0x03,  0x89,  0x05,  0xcc,  0x2a,  0xda,  0xcd,  0x3c,  0x5a,  0x17,  0x6f,  0xe9,  0x18,  0xb2,  0x97,  0xef,  0x1c,  0x37,  0xf7,  0x2b,  0x26,  0x76,  0x6c,  0x78,  0xb2,  0xa6,  0x05,  0xca,  0x19,  0x78,  0xf7,  0x8b};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);


    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}


bool testEcdsaSignature1()
{    
    uint8_t m[32] = {0xbc,  0x2b,  0xab,  0x89,  0xf4,  0x34,  0xb1,  0x12,  0xea,  0x0b,  0x08,  0xf4,  0x9f,  0x0b,  0x4e,  0x11,  0xc0,  0xde,  0xc1,  0x6c,  0x4d,  0x8b,  0x60,  0xc7,  0x3c,  0xfa,  0xe8,  0xb0,  0x9c,  0xb8,  0x2d,  0x9b};
    uint8_t privateKey[32] = {0x13,  0x98,  0x47,  0x85,  0x7b,  0x53,  0x01,  0xc2,  0x9a,  0x51,  0xbb,  0x8e,  0xf4,  0xaa,  0x25,  0x9a,  0x99,  0xed,  0x4b,  0x82,  0x64,  0x00,  0x50,  0x5c,  0x05,  0x0b,  0x46,  0xca,  0x78,  0xdb,  0x56,  0x0f};
    uint8_t k[32] = {0xc6,  0x34,  0x2f,  0x0b,  0xae,  0x87,  0x11,  0x42,  0xac,  0x9f,  0xae,  0xd3,  0x68,  0x80,  0x72,  0xfb,  0xa9,  0x4a,  0x18,  0xab,  0xe0,  0x14,  0xbb,  0x56,  0xb1,  0x83,  0x3b,  0x2c,  0x88,  0x71,  0x3e,  0x6d};

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t expectedR[32] = {0xdb,  0xb2,  0x79,  0x10,  0xa1,  0xb6,  0x73,  0x64,  0x3a,  0x48,  0x08,  0xf5,  0x64,  0x28,  0xf4,  0x53,  0x4e,  0x7c,  0x0b,  0x56,  0xfa,  0xa9,  0xba,  0xc0,  0x6d,  0x32,  0x23,  0x9d,  0x4e,  0x3a,  0x6d,  0x97};
    uint8_t expectedS[32] = {0x32,  0x19,  0x6e,  0xe3,  0xef,  0xee,  0xb8,  0x55,  0x45,  0x7d,  0x01,  0xe5,  0x2a,  0x65,  0xfa,  0x4c,  0xcd,  0x62,  0xf4,  0x0a,  0x6e,  0xd4,  0xdc,  0x01,  0x6c,  0xba,  0x71,  0xeb,  0x9c,  0x6e,  0x76,  0x1b};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);


    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}


bool testEcdsaSignature2()
{    
    uint8_t m[32] = {0xf0,  0xcf,  0xda,  0x61,  0x80,  0x81,  0x19,  0x4e,  0x88,  0x58,  0xd4,  0xeb,  0xd3,  0xe9,  0x38,  0x41,  0x29,  0xb3,  0xeb,  0x60,  0x36,  0xfb,  0xbb,  0x8b,  0xff,  0x2e,  0x0c,  0xaf,  0x88,  0xcf,  0x04,  0xb8};
    uint8_t privateKey[32] = {0xef,  0xc2,  0x1f,  0xad,  0x4c,  0xd6,  0x40,  0xa0,  0xbc,  0x62,  0x2e,  0x99,  0x8c,  0x91,  0x1c,  0xf6,  0x3b,  0xf6,  0x1a,  0x6e,  0x9e,  0x78,  0x5f,  0xb9,  0x13,  0x7e,  0x83,  0x39,  0x12,  0x87,  0x83,  0xe2};
    uint8_t k[32] = {0xe2,  0x5d,  0x83,  0xd0,  0xb5,  0x97,  0xa2,  0x31,  0x2f,  0x4c,  0x12,  0xe0,  0x43,  0x62,  0xd2,  0xf4,  0x60,  0x8a,  0xff,  0xe5,  0xd6,  0x0a,  0x28,  0xd8,  0xb8,  0x80,  0xb3,  0xb2,  0x7e,  0x88,  0x5e,  0xad};

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t expectedR[32] = {0xd1,  0x6b,  0x6f,  0xbb,  0xc2,  0xfa,  0x83,  0x15,  0x5e,  0x6a,  0xee,  0x90,  0x7a,  0xab,  0x2c,  0x3a,  0x26,  0xc8,  0x41,  0xc6,  0x3c,  0xfb,  0x42,  0x85,  0xa0,  0x3c,  0x0f,  0xca,  0xf5,  0x60,  0xfb,  0x35};
    uint8_t expectedS[32] = {0x96,  0x2e,  0x57,  0x92,  0xb2,  0x9b,  0xb9,  0x07,  0xa4,  0xa9,  0xd0,  0x11,  0x85,  0xe9,  0x04,  0xaf,  0x84,  0x87,  0x9d,  0x15,  0x7b,  0xd9,  0x0e,  0xcc,  0x55,  0x10,  0xdb,  0xc9,  0x1b,  0xd8,  0x59,  0xee};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);


    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}


bool testEcdsaSignature3()
{    
    uint8_t m[32] = {0x1a,  0x8a,  0x60,  0xf9,  0x2f,  0x5c,  0xcb,  0x3b,  0xe4,  0xd1,  0x86,  0xf4,  0x99,  0xb4,  0x3c,  0x7f,  0xe9,  0xfb,  0x7c,  0x44,  0xc5,  0x0a,  0x88,  0x7c,  0x5e,  0x23,  0x66,  0x27,  0xd9,  0x57,  0xb9,  0x85};
    uint8_t privateKey[32] = {0x07,  0x2d,  0xf7,  0x8c,  0x01,  0x90,  0x94,  0x34,  0x75,  0xbb,  0xd7,  0x90,  0x7a,  0x02,  0x10,  0x7f,  0x83,  0x41,  0x0d,  0xe1,  0xbf,  0xb4,  0x98,  0xce,  0x92,  0x65,  0x6f,  0x59,  0xb7,  0xd3,  0xd2,  0xa3};
    uint8_t k[32] = {0x18,  0x4f,  0x83,  0xe5,  0xf4,  0x5d,  0x11,  0x3a,  0xe3,  0xba,  0xa4,  0xe3,  0x17,  0xac,  0xaa,  0xd1,  0x1e,  0x47,  0xb9,  0x96,  0xcc,  0x84,  0xfe,  0xf9,  0x7e,  0xf1,  0x13,  0xda,  0xe1,  0x90,  0xfc,  0x24};

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t expectedR[32] = {0xca,  0x84,  0x58,  0x0e,  0x7c,  0xe0,  0x7c,  0x88,  0xb7,  0x41,  0xde,  0x22,  0xf3,  0xcb,  0xb1,  0x0b,  0xd5,  0x8b,  0xcc,  0x68,  0x24,  0x4a,  0xc8,  0x81,  0xb5,  0x17,  0xf6,  0x0a,  0x37,  0x62,  0xc5,  0xd7};
    uint8_t expectedS[32] = {0x89,  0x0d,  0x67,  0x4d,  0xd9,  0x21,  0xcb,  0x25,  0xb8,  0xcb,  0xc5,  0xec,  0xe8,  0x64,  0x8d,  0x00,  0x7c,  0x93,  0x78,  0x1d,  0x8f,  0x17,  0xff,  0x46,  0x35,  0xf8,  0x4b,  0x8c,  0x2d,  0x9f,  0x6d,  0xb4};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);


    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}


bool testEcdsaSignature4()
{    
    uint8_t m[32] = {0x22,  0x6e,  0x66,  0x5b,  0xb5,  0x41,  0x2d,  0x68,  0x3b,  0x73,  0xd7,  0x0c,  0xc8,  0x7d,  0xe5,  0xbe,  0x35,  0xb6,  0x7c,  0x8d,  0x69,  0xcf,  0x27,  0x08,  0x84,  0x21,  0x2f,  0x22,  0x99,  0xd6,  0x60,  0x33};
    uint8_t privateKey[32] = {0x0d,  0x28,  0x2d,  0x27,  0x6c,  0x62,  0x83,  0xd5,  0x27,  0x58,  0x53,  0x3a,  0x9b,  0x07,  0xbd,  0x2e,  0x10,  0x2a,  0x88,  0xa9,  0xe1,  0x94,  0xae,  0xe7,  0x01,  0xdb,  0x93,  0xfe,  0xa8,  0xe8,  0xa0,  0x53};
    uint8_t k[32] = {0xc4,  0xe0,  0x84,  0xbe,  0xfa,  0xb8,  0xed,  0x0b,  0x1b,  0xa7,  0xce,  0x58,  0x83,  0xb4,  0xde,  0xcd,  0x87,  0x35,  0x2a,  0x85,  0xec,  0xe7,  0x7e,  0x2d,  0x40,  0x7a,  0xcc,  0x24,  0x8d,  0x3e,  0x83,  0x5d};

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t expectedR[32] = {0x04,  0x26,  0x18,  0x87,  0xc3,  0xa7,  0xa9,  0xa3,  0xdf,  0x51,  0x5e,  0xaf,  0x80,  0xc0,  0x03,  0x57,  0xdc,  0xc9,  0xde,  0x36,  0xb8,  0x92,  0xd9,  0xbc,  0xa8,  0x07,  0x35,  0x66,  0x7b,  0xaf,  0xca,  0x18};
    uint8_t expectedS[32] = {0x9c,  0xd2,  0x52,  0x83,  0xa9,  0xdf,  0x13,  0xc6,  0x96,  0xf7,  0x1a,  0xc8,  0xa5,  0x8b,  0xc1,  0x45,  0xff,  0xb7,  0x5f,  0x61,  0xfb,  0x43,  0xfb,  0x85,  0xd9,  0x88,  0x3b,  0xac,  0x28,  0x89,  0xc6,  0x77};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);

    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}


bool testEcdsaSignature5()
{    
    uint8_t m[32] = {0x57,  0xca,  0x77,  0xa5,  0xc3,  0x88,  0x94,  0xec,  0x5c,  0x1a,  0xd6,  0xcb,  0x7f,  0xbe,  0xf5,  0x2c,  0x3b,  0x04,  0x03,  0xa1,  0x1a,  0x00,  0x32,  0x8e,  0x6d,  0xbc,  0xd0,  0x8c,  0x90,  0xc4,  0x13,  0xc4};
    uint8_t privateKey[32] = {0x1d,  0x4a,  0xfc,  0xae,  0x33,  0x38,  0x4b,  0xab,  0x49,  0x5b,  0x85,  0x07,  0x30,  0x13,  0x6a,  0x18,  0xc9,  0x1b,  0x51,  0x65,  0x2a,  0x71,  0xfb,  0x0f,  0x83,  0x4c,  0x19,  0xe2,  0xe8,  0x07,  0xf1,  0x4a};
    uint8_t k[32] = {0xab,  0xd0,  0x38,  0xc2,  0x1f,  0x59,  0x20,  0x1e,  0xb3,  0xf0,  0x34,  0x41,  0x31,  0xad,  0x54,  0xcd,  0x38,  0xc3,  0xd4,  0x59,  0x91,  0xec,  0xfa,  0xcd,  0xd3,  0x2f,  0xfa,  0x4d,  0xf8,  0x96,  0x8f,  0xe1};

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t expectedR[32] = {0x68,  0x2e,  0x8f,  0xc7,  0xdb,  0x4f,  0xa8,  0x72,  0xa3,  0x15,  0x52,  0xd0,  0x0e,  0xad,  0xbb,  0x73,  0x78,  0xf5,  0x29,  0x91,  0x2d,  0xc7,  0xe8,  0xbd,  0x73,  0x9a,  0x2d,  0x4e,  0x02,  0xc5,  0x24,  0x85};
    uint8_t expectedS[32] = {0xcb,  0x05,  0x5a,  0xeb,  0x28,  0x03,  0x76,  0x44,  0x02,  0x64,  0x9c,  0x46,  0x03,  0xda,  0xca,  0x01,  0x13,  0xf5,  0x53,  0x89,  0x5e,  0xec,  0x64,  0x70,  0xf8,  0x72,  0x10,  0x3b,  0xaf,  0x2c,  0x8c,  0xd1};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);

    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}


bool testEcdsaSignature6()
{    
    uint8_t m[32] = {0x98,  0x28,  0x5b,  0x9e,  0x68,  0xe8,  0x79,  0xaa,  0xbd,  0xce,  0xd8,  0x3c,  0x6c,  0xb8,  0x02,  0xdb,  0xc0,  0xee,  0x5d,  0x13,  0xfa,  0x35,  0xb1,  0x51,  0xfc,  0x94,  0x97,  0x84,  0x7d,  0x1e,  0xfc,  0x88};
    uint8_t privateKey[32] = {0xab,  0xf4,  0xba,  0x8e,  0xc4,  0x92,  0x35,  0x05,  0x75,  0x84,  0x12,  0xa0,  0xaa,  0x22,  0xb8,  0xcf,  0xdd,  0x4c,  0x49,  0x77,  0xe4,  0x06,  0xe2,  0xb3,  0x50,  0x68,  0x07,  0xf1,  0x09,  0xaa,  0xdf,  0x78};
    uint8_t k[32] = {0x77,  0x8a,  0x25,  0x5c,  0x6a,  0xb6,  0x02,  0x1a,  0xf1,  0x45,  0x14,  0x89,  0x4e,  0xed,  0xf7,  0x0a,  0xd4,  0x51,  0x65,  0x2c,  0x9b,  0x1c,  0x74,  0x70,  0xa1,  0x3d,  0xda,  0xb2,  0xdb,  0x44,  0x55,  0x29};

    uint8_t* result = (uint8_t *) malloc (sizeof (uint8_t) * 64);

    uint8_t expectedR[32] = {0x54,  0xb2,  0xc9,  0xac,  0x7a,  0xf8,  0x05,  0x53,  0xd9,  0x88,  0x00,  0x5c,  0xf0,  0x87,  0x50,  0x82,  0xfe,  0x0b,  0x97,  0x38,  0xf3,  0xf7,  0x80,  0x54,  0x01,  0x52,  0xf4,  0x2d,  0xd7,  0x86,  0xa1,  0xc5};
    uint8_t expectedS[32] = {0x30,  0xca,  0x31,  0xee,  0x7b,  0x9d,  0x96,  0x2e,  0xd9,  0x82,  0xdc,  0x47,  0x51,  0xb8,  0x65,  0x56,  0x18,  0xb5,  0x1a,  0xaa,  0xb1,  0x16,  0xb3,  0x44,  0x53,  0x73,  0x9e,  0x9d,  0x9e,  0x8f,  0xa5,  0x84};

    uint64_t flag = Hacl_Impl_ECDSA_ecdsa_p256_sha2_sign_nist(result, m, privateKey, k);
    
    bool flagCorrectR = true;
    for (int i = 0; i < 32; i++)
        flagCorrectR = flagCorrectR && (result[i] == expectedR[i]);

    bool flagCorrectS = true;
    for (int i = 0; i < 32; i++)
        flagCorrectS = flagCorrectS && (result[i + 32] == expectedS[i]);

    uint64_t expectedResult = 0x0;
    return (expectedResult == flag) && flagCorrectR && flagCorrectS;
}



void testEcdsaVerification0()
   {

    const uint8_t mLen = 128;
    uint8_t m[128] = {0x0e,  0x17,  0x16,  0x76,  0x55,  0x17,  0x50,  0x47,  0x19,  0x62,  0x74,  0xa0,  0xfd,  0x5e,  0x8f,  0x19,  0x73,  0x52,  0xaf,  0x72,  0x39,  0xdd,  0xdd,  0x4f,  0x92,  0x93,  0x0e,  0x26,  0x12,  0xea,  0x69,  0x35,  0x2b,  0x1b,  0xd9,  0x1a,  0xe8,  0xd0,  0x9b,  0xdc,  0xaa,  0xec,  0xc8,  0x88,  0x77,  0x6f,  0x9c,  0x4c,  0x89,  0x3b,  0x2f,  0xf6,  0x63,  0xdc,  0xae,  0x62,  0x6c,  0xc5,  0x5d,  0xbf,  0x9c,  0x78,  0x65,  0x45,  0x00,  0x73,  0x18,  0xae,  0x89,  0x19,  0x48,  0xf1,  0x91,  0xde,  0xe7,  0x94,  0x40,  0x96,  0x19,  0x00,  0xed,  0x00,  0xe9,  0xc4,  0xfa,  0xd8,  0x23,  0x16,  0xc8,  0xd6,  0xc6,  0xec,  0x95,  0x7f,  0x87,  0x83,  0xd6,  0x62,  0x54,  0x65,  0x85,  0x45,  0x52,  0x5d,  0x65,  0x0c,  0xf1,  0xce,  0x53,  0x66,  0xc3,  0x82,  0x21,  0xdd,  0x80,  0xcd,  0x97,  0x69,  0xef,  0xf6,  0x6d,  0xee,  0xdf,  0x93,  0x6b,  0x6e,  0x9a,  0x06};
      
    uint64_t pubKey[32] = {0xec, 0x53, 0x0c, 0xe3, 0xcc, 0x5c, 0x9d, 0x1a, 
        0xf4, 0x63, 0xf2, 0x64, 0xd6, 0x85, 0xaf, 0xe2, 
        0xb4, 0xdb, 0x4b, 0x58, 0x28, 0xd7, 0xe6, 0x1b, 
        0x74, 0x89, 0x30, 0xf3, 0xce, 0x62, 0x2a, 0x85,
        0x5c, 0xf0, 0x2a, 0x00, 0xd2, 0x05, 0xbd, 0xfe, 0xe2, 0x01, 0x6f, 0x74, 0x21, 0x80, 0x7f, 0xc3, 0x8a, 0xe6, 0x9e, 0x6b, 0x7c, 0xcd, 0x06, 0x4e, 0xe6, 0x89, 0xfc, 0x1a, 0x94, 0xa9, 0xf7, 0xd2};
    uint64_t* r = (uint64_t *) malloc (sizeof (uint64_t) * 4);
    uint64_t* s = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      
      // pubKey[3] = 0x5cf02a00d205bdfeul;
      // pubKey[2] = 0xe2016f7421807fc3ul;
      // pubKey[1] = 0x8ae69e6b7ccd064eul;
      // pubKey[0] = 0xe689fc1a94a9f7d2ul;

      // pubKey[7] = 0xec530ce3cc5c9d1aul;
      // pubKey[6] = 0xf463f264d685afe2ul;
      // pubKey[5] = 0xb4db4b5828d7e61bul;
      // pubKey[4] = 0x748930f3ce622a85ul;

      r[3] =  0xdc23d130c6117fb5ul;
      r[2] =  0x751201455e99f36ful;
      r[1] =  0x59aba1a6a21cf2d0ul;
      r[0] =  0xe7481a97451d6693ul;
 
      s[3] =  0xd6ce7708c18dbf35ul;
      s[2] =  0xd4f8aa7240922dc6ul;
      s[1] =  0x823f2e7058cbc148ul;
      s[0] =  0x4fcad1599db5018cul;

      bool result = Hacl_Impl_ECDSA_ecdsa_p256_sha2_verify (mLen, m , pubKey, r, s);

      bool expectedResult = false;
      if (result == expectedResult)
        printf("%s\n", "Test4: passed");
      else
        printf("%s\n", "Test4: failed");
}

void testEcdsaVerification1()
   {
      uint8_t m[128] = {0xe1,  0x13,  0x0a,  0xf6,  0xa3,  0x8c,  0xcb,  0x41,  0x2a,  0x9c,  0x8d,  0x13,  0xe1,  0x5d,  0xbf,  0xc9,  0xe6,  0x9a,  0x16,  0x38,  0x5a,  0xf3,  0xc3,  0xf1,  0xe5,  0xda,  0x95,  0x4f,  0xd5,  0xe7,  0xc4,  0x5f,  0xd7,  0x5e,  0x2b,  0x8c,  0x36,  0x69,  0x92,  0x28,  0xe9,  0x28,  0x40,  0xc0,  0x56,  0x2f,  0xbf,  0x37,  0x72,  0xf0,  0x7e,  0x17,  0xf1,  0xad,  0xd5,  0x65,  0x88,  0xdd,  0x45,  0xf7,  0x45,  0x0e,  0x12,  0x17,  0xad,  0x23,  0x99,  0x22,  0xdd,  0x9c,  0x32,  0x69,  0x5d,  0xc7,  0x1f,  0xf2,  0x42,  0x4c,  0xa0,  0xde,  0xc1,  0x32,  0x1a,  0xa4,  0x70,  0x64,  0xa0,  0x44,  0xb7,  0xfe,  0x3c,  0x2b,  0x97,  0xd0,  0x3c,  0xe4,  0x70,  0xa5,  0x92,  0x30,  0x4c,  0x5e,  0xf2,  0x1e,  0xed,  0x9f,  0x93,  0xda,  0x56,  0xbb,  0x23,  0x2d,  0x1e,  0xeb,  0x00,  0x35,  0xf9,  0xbf,  0x0d,  0xfa,  0xfd,  0xcc,  0x46,  0x06,  0x27,  0x2b,  0x20,  0xa3};


      uint32_t mLen = 128;
      uint64_t* pubKey = (uint64_t *) malloc (sizeof (uint64_t) * 12);
      uint64_t* r = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      uint64_t* s = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      
      pubKey[3] = 0xe424dc61d4bb3cb7ul;
      pubKey[2] = 0xef4344a7f8957a0cul;
      pubKey[1] = 0x5134e16f7a67c074ul;
      pubKey[0] = 0xf82e6e12f49abf3cul;

      pubKey[7] = 0x970eed7aa2bc4865ul;
      pubKey[6] = 0x1545949de1dddaf0ul;
      pubKey[5] = 0x127e5965ac85d124ul;
      pubKey[4] = 0x3d6f60e7dfaee927ul;

      r[3] =  0xbf96b99aa49c705cul;
      r[2] =  0x910be33142017c64ul;
      r[1] =  0x2ff540c76349b9daul;
      r[0] =  0xb72f981fd9347f4ful;
 
      s[3] =  0x17c55095819089c2ul;
      s[2] =  0xe03b9cd415abdf12ul;
      s[1] =  0x444e323075d98f31ul;
      s[0] =  0x920b9e0f57ec871cul;

      bool result = Hacl_Impl_ECDSA_ecdsa_p256_sha2_verify_u8 (mLen, m, pubKey, r, s);

      bool expectedResult = true;
      if (result == expectedResult)
        printf("%s\n", "Test0: passed");
      else
        printf("%s\n", "Test0: failed");
}


void testEcdsaVerification2()
   {
      uint8_t* m = (uint8_t *) malloc (sizeof (uint8_t) * 128);
      m[0] = 0xe4;
      m[1] = 0x79;
      m[2] = 0x6d;
      m[3] = 0xb5;
      m[4] = 0xf7;
      m[5] = 0x85;
      m[6] = 0xf2;
      m[7] = 0x07;
      m[8] = 0xaa;
      m[9] = 0x30;
      m[10] = 0xd3;
      m[11] = 0x11;
      m[12] = 0x69;
      m[13] = 0x3b;
      m[14] = 0x37;
      m[15] = 0x02;
      m[16] = 0x82;
      m[17] = 0x1d;
      m[18] = 0xff;
      m[19] = 0x11;
      m[20] = 0x68;
      m[21] = 0xfd;
      m[22] = 0x2e;
      m[23] = 0x04;
      m[24] = 0xc0;
      m[25] = 0x83;
      m[26] = 0x68;
      m[27] = 0x25;
      m[28] = 0xae;
      m[29] = 0xfd;
      m[30] = 0x85;
      m[31] = 0x0d;
      m[32] = 0x9a;
      m[33] = 0xa6;
      m[34] = 0x03;
      m[35] = 0x26;
      m[36] = 0xd8;
      m[37] = 0x8c;
      m[38] = 0xde;
      m[39] = 0x1a;
      m[40] = 0x23;
      m[41] = 0xc7;
      m[42] = 0x74;
      m[43] = 0x53;
      m[44] = 0x51;
      m[45] = 0x39;
      m[46] = 0x2c;
      m[47] = 0xa2;
      m[48] = 0x28;
      m[49] = 0x8d;
      m[50] = 0x63;
      m[51] = 0x2c;
      m[52] = 0x26;
      m[53] = 0x4f;
      m[54] = 0x19;
      m[55] = 0x7d;
      m[56] = 0x05;
      m[57] = 0xcd;
      m[58] = 0x42;
      m[59] = 0x4a;
      m[60] = 0x30;
      m[61] = 0x33;
      m[62] = 0x6c;
      m[63] = 0x19;
      m[64] = 0xfd;
      m[65] = 0x09;
      m[66] = 0xbb;
      m[67] = 0x22;
      m[68] = 0x96;
      m[69] = 0x54;
      m[70] = 0xf0;
      m[71] = 0x22;
      m[72] = 0x2f;
      m[73] = 0xcb;
      m[74] = 0x88;
      m[75] = 0x1a;
      m[76] = 0x4b;
      m[77] = 0x35;
      m[78] = 0xc2;
      m[79] = 0x90;
      m[80] = 0xa0;
      m[81] = 0x93;
      m[82] = 0xac;
      m[83] = 0x15;
      m[84] = 0x9c;
      m[85] = 0xe1;
      m[86] = 0x34;
      m[87] = 0x09;
      m[88] = 0x11;
      m[89] = 0x1f;
      m[90] = 0xf0;
      m[91] = 0x35;
      m[92] = 0x84;
      m[93] = 0x11;
      m[94] = 0x13;
      m[95] = 0x3c;
      m[96] = 0x24;
      m[97] = 0xf5;
      m[98] = 0xb8;
      m[99] = 0xe2;
      m[100] = 0x09;
      m[101] = 0x0d;
      m[102] = 0x6d;
      m[103] = 0xb6;
      m[104] = 0x55;
      m[105] = 0x8a;
      m[106] = 0xfc;
      m[107] = 0x36;
      m[108] = 0xf0;
      m[109] = 0x6c;
      m[110] = 0xa1;
      m[111] = 0xf6;
      m[112] = 0xef;
      m[113] = 0x77;
      m[114] = 0x97;
      m[115] = 0x85;
      m[116] = 0xad;
      m[117] = 0xba;
      m[118] = 0x68;
      m[119] = 0xdb;
      m[120] = 0x27;
      m[121] = 0xa4;
      m[122] = 0x09;
      m[123] = 0x85;
      m[124] = 0x9f;
      m[125] = 0xc4;
      m[126] = 0xc4;
      m[127] = 0xa0;


      uint32_t mLen = 128;
      uint64_t* pubKey = (uint64_t *) malloc (sizeof (uint64_t) * 12);
      uint64_t* r = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      uint64_t* s = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      
      pubKey[3] = 0x87f8f2b218f49845ul;
      pubKey[2] = 0xf6f10eec38771362ul;
      pubKey[1] = 0x69f5c1a54736dbdful;
      pubKey[0] = 0x69f89940cad41555ul;

      pubKey[7] = 0xe15f369036f49842;
      pubKey[6] = 0xfac7a86c8a2b0557;
      pubKey[5] = 0x609776814448b8f5;
      pubKey[4] = 0xe84aa9f4395205e9;

      r[3] =  0xd19ff48b32491557;
      r[2] =  0x6416097d2544f7cb;
      r[1] =  0xdf8768b1454ad20e;
      r[0] =  0x0baac50e211f23b0;
 
      s[3] =  0xa3e81e59311cdfff;
      s[2] =  0x2d4784949f7a2cb5;
      s[1] =  0x0ba6c3a91fa54710;
      s[0] =  0x568e61aca3e847c6;

      bool result = Hacl_Impl_ECDSA_ecdsa_p256_sha2_verify  (mLen, m , pubKey, r, s);

      bool expectedResult = false;
      if (result == expectedResult)
        printf("%s\n", "Test1: passed");
      else
        printf("%s\n", "Test1: failed");
}

void testEcdsaVerification3()
   {
      uint8_t* m = (uint8_t *) malloc (sizeof (uint8_t) * 128);
      m[0] = 0x73;
      m[1] = 0xc5;
      m[2] = 0xf6;
      m[3] = 0xa6;
      m[4] = 0x74;
      m[5] = 0x56;
      m[6] = 0xae;
      m[7] = 0x48;
      m[8] = 0x20;
      m[9] = 0x9b;
      m[10] = 0x5f;
      m[11] = 0x85;
      m[12] = 0xd1;
      m[13] = 0xe7;
      m[14] = 0xde;
      m[15] = 0x77;
      m[16] = 0x58;
      m[17] = 0xbf;
      m[18] = 0x23;
      m[19] = 0x53;
      m[20] = 0x00;
      m[21] = 0xc6;
      m[22] = 0xae;
      m[23] = 0x2b;
      m[24] = 0xdc;
      m[25] = 0xeb;
      m[26] = 0x1d;
      m[27] = 0xcb;
      m[28] = 0x27;
      m[29] = 0xa7;
      m[30] = 0x73;
      m[31] = 0x0f;
      m[32] = 0xb6;
      m[33] = 0x8c;
      m[34] = 0x95;
      m[35] = 0x0b;
      m[36] = 0x7f;
      m[37] = 0xca;
      m[38] = 0xda;
      m[39] = 0x0e;
      m[40] = 0xcc;
      m[41] = 0x46;
      m[42] = 0x61;
      m[43] = 0xd3;
      m[44] = 0x57;
      m[45] = 0x82;
      m[46] = 0x30;
      m[47] = 0xf2;
      m[48] = 0x25;
      m[49] = 0xa8;
      m[50] = 0x75;
      m[51] = 0xe6;
      m[52] = 0x9a;
      m[53] = 0xaa;
      m[54] = 0x17;
      m[55] = 0xf1;
      m[56] = 0xe7;
      m[57] = 0x1c;
      m[58] = 0x6b;
      m[59] = 0xe5;
      m[60] = 0xc8;
      m[61] = 0x31;
      m[62] = 0xf2;
      m[63] = 0x26;
      m[64] = 0x63;
      m[65] = 0xba;
      m[66] = 0xc6;
      m[67] = 0x3d;
      m[68] = 0x0c;
      m[69] = 0x7a;
      m[70] = 0x96;
      m[71] = 0x35;
      m[72] = 0xed;
      m[73] = 0xb0;
      m[74] = 0x04;
      m[75] = 0x3f;
      m[76] = 0xf8;
      m[77] = 0xc6;
      m[78] = 0xf2;
      m[79] = 0x64;
      m[80] = 0x70;
      m[81] = 0xf0;
      m[82] = 0x2a;
      m[83] = 0x7b;
      m[84] = 0xc5;
      m[85] = 0x65;
      m[86] = 0x56;
      m[87] = 0xf1;
      m[88] = 0x43;
      m[89] = 0x7f;
      m[90] = 0x06;
      m[91] = 0xdf;
      m[92] = 0xa2;
      m[93] = 0x7b;
      m[94] = 0x48;
      m[95] = 0x7a;
      m[96] = 0x6c;
      m[97] = 0x42;
      m[98] = 0x90;
      m[99] = 0xd8;
      m[100] = 0xba;
      m[101] = 0xd3;
      m[102] = 0x8d;
      m[103] = 0x48;
      m[104] = 0x79;
      m[105] = 0xb3;
      m[106] = 0x34;
      m[107] = 0xe3;
      m[108] = 0x41;
      m[109] = 0xba;
      m[110] = 0x09;
      m[111] = 0x2d;
      m[112] = 0xde;
      m[113] = 0x4e;
      m[114] = 0x4a;
      m[115] = 0xe6;
      m[116] = 0x94;
      m[117] = 0xa9;
      m[118] = 0xc0;
      m[119] = 0x93;
      m[120] = 0x02;
      m[121] = 0xe2;
      m[122] = 0xdb;
      m[123] = 0xf4;
      m[124] = 0x43;
      m[125] = 0x58;
      m[126] = 0x1c;
      m[127] = 0x08;




      uint32_t mLen = 128;
      uint64_t* pubKey = (uint64_t *) malloc (sizeof (uint64_t) * 12);
      uint64_t* r = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      uint64_t* s = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      
      pubKey[3] = 0xe0fc6a6f50e1c574;
      pubKey[2] = 0x75673ee54e3a57f9;
      pubKey[1] = 0xa49f3328e743bf52;
      pubKey[0] = 0xf335e3eeaa3d2864;

      pubKey[7] = 0x7f59d689c91e4636;
      pubKey[6] = 0x07d9194d99faf316;
      pubKey[5] = 0xe25432870816dde6;
      pubKey[4] = 0x3f5d4b373f12f22a;

      r[3] =  0x1d75830cd36f4c9a;
      r[2] =  0xa181b2c4221e87f1;
      r[1] =  0x76b7f05b7c87824e;
      r[0] =  0x82e396c88315c407;
 
      s[3] =  0xcb2acb01dac96efc;
      s[2] =  0x53a32d4a0d85d0c2;
      s[1] =  0xe48955214783ecf5;
      s[0] =  0x0a4f0414a319c05a;

      bool result = Hacl_Impl_ECDSA_ecdsa_p256_sha2_verify  (mLen, m , pubKey, r, s);

      bool expectedResult = true;
      if (result == expectedResult)
        printf("%s\n", "Test2: passed");
      else
        printf("%s\n", "Test2: failed");
}

void testEcdsaVerification4()
   {
      uint8_t* m = (uint8_t *) malloc (sizeof (uint8_t) * 128);
      m[0] = 0x60;
      m[1] = 0xcd;
      m[2] = 0x64;
      m[3] = 0xb2;
      m[4] = 0xcd;
      m[5] = 0x2b;
      m[6] = 0xe6;
      m[7] = 0xc3;
      m[8] = 0x38;
      m[9] = 0x59;
      m[10] = 0xb9;
      m[11] = 0x48;
      m[12] = 0x75;
      m[13] = 0x12;
      m[14] = 0x03;
      m[15] = 0x61;
      m[16] = 0xa2;
      m[17] = 0x40;
      m[18] = 0x85;
      m[19] = 0xf3;
      m[20] = 0x76;
      m[21] = 0x5c;
      m[22] = 0xb8;
      m[23] = 0xb2;
      m[24] = 0xbf;
      m[25] = 0x11;
      m[26] = 0xe0;
      m[27] = 0x26;
      m[28] = 0xfa;
      m[29] = 0x9d;
      m[30] = 0x88;
      m[31] = 0x55;
      m[32] = 0xdb;
      m[33] = 0xe4;
      m[34] = 0x35;
      m[35] = 0xac;
      m[36] = 0xf7;
      m[37] = 0x88;
      m[38] = 0x2e;
      m[39] = 0x84;
      m[40] = 0xf3;
      m[41] = 0xc7;
      m[42] = 0x85;
      m[43] = 0x7f;
      m[44] = 0x96;
      m[45] = 0xe2;
      m[46] = 0xba;
      m[47] = 0xab;
      m[48] = 0x4d;
      m[49] = 0x9a;
      m[50] = 0xfe;
      m[51] = 0x45;
      m[52] = 0x88;
      m[53] = 0xe4;
      m[54] = 0xa8;
      m[55] = 0x2e;
      m[56] = 0x17;
      m[57] = 0xa7;
      m[58] = 0x88;
      m[59] = 0x27;
      m[60] = 0xbf;
      m[61] = 0xdb;
      m[62] = 0x5d;
      m[63] = 0xdb;
      m[64] = 0xd1;
      m[65] = 0xc2;
      m[66] = 0x11;
      m[67] = 0xfb;
      m[68] = 0xc2;
      m[69] = 0xe6;
      m[70] = 0xd8;
      m[71] = 0x84;
      m[72] = 0xcd;
      m[73] = 0xdd;
      m[74] = 0x7c;
      m[75] = 0xb9;
      m[76] = 0xd9;
      m[77] = 0x0d;
      m[78] = 0x5b;
      m[79] = 0xf4;
      m[80] = 0xa7;
      m[81] = 0x31;
      m[82] = 0x1b;
      m[83] = 0x83;
      m[84] = 0xf3;
      m[85] = 0x52;
      m[86] = 0x50;
      m[87] = 0x80;
      m[88] = 0x33;
      m[89] = 0x81;
      m[90] = 0x2c;
      m[91] = 0x77;
      m[92] = 0x6a;
      m[93] = 0x0e;
      m[94] = 0x00;
      m[95] = 0xc0;
      m[96] = 0x03;
      m[97] = 0xc7;
      m[98] = 0xe0;
      m[99] = 0xd6;
      m[100] = 0x28;
      m[101] = 0xe5;
      m[102] = 0x07;
      m[103] = 0x36;
      m[104] = 0xc7;
      m[105] = 0x51;
      m[106] = 0x2d;
      m[107] = 0xf0;
      m[108] = 0xac;
      m[109] = 0xfa;
      m[110] = 0x9f;
      m[111] = 0x23;
      m[112] = 0x20;
      m[113] = 0xbd;
      m[114] = 0x10;
      m[115] = 0x22;
      m[116] = 0x29;
      m[117] = 0xf4;
      m[118] = 0x64;
      m[119] = 0x95;
      m[120] = 0xae;
      m[121] = 0x6d;
      m[122] = 0x08;
      m[123] = 0x57;
      m[124] = 0xcc;
      m[125] = 0x45;
      m[126] = 0x2a;
      m[127] = 0x84;


      uint32_t mLen = 128;
      uint64_t* pubKey = (uint64_t *) malloc (sizeof (uint64_t) * 12);
      uint64_t* r = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      uint64_t* s = (uint64_t *) malloc (sizeof (uint64_t) * 4);
      
      pubKey[3] = 0x2d98ea01f754d34bul;
      pubKey[2] = 0xbc3003df5050200a;
      pubKey[1] = 0xbf445ec728556d7e;
      pubKey[0] = 0xd7d5c54c55552b6d;

      pubKey[7] = 0x9b52672742d637a3;
      pubKey[6] = 0x2add056dfd6d8792;
      pubKey[5] = 0xf2a33c2e69dafabe;
      pubKey[4] = 0xa09b960bc61e230a;

      r[3] =  0x06108e525f845d01;
      r[2] =  0x55bf60193222b321;
      r[1] =  0x9c98e3d49424c2fb;
      r[0] =  0x2a0987f825c17959;
 
      s[3] =  0x62b5cdd591e5b507;
      s[2] =  0xe560167ba8f6f7cd;
      s[1] =  0xa74673eb315680cb;
      s[0] =  0x89ccbc4eec477dce;

      bool result = Hacl_Impl_ECDSA_ecdsa_p256_sha2_verify  (mLen, m , pubKey, r, s);

      bool expectedResult = true;
      if (result == expectedResult)
        printf("%s\n", "Test5: passed");
      else
        printf("%s\n", "Test5: failed");
}



int main()
{
    if (!testEcdsaSignature0())
        return EXIT_FAILURE; 
    if (!testEcdsaSignature1())
        return EXIT_FAILURE;
    if (!testEcdsaSignature2())
        return EXIT_FAILURE;
    if (!testEcdsaSignature3())
        return EXIT_FAILURE;
    if (!testEcdsaSignature4())
        return EXIT_FAILURE;
    if (!testEcdsaSignature5())
        return EXIT_FAILURE;
    if (!testEcdsaSignature6())
        return EXIT_FAILURE;
    
    printf("%s\n", "Verification and testing of ECDSA was completed successfully");
    // return EXIT_SUCCESS;

    testEcdsaVerification0();
    testEcdsaVerification1();
    testEcdsaVerification2();
    testEcdsaVerification3();
    testEcdsaVerification4();

}